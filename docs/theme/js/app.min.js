const navSwitcher=document.querySelector(".nav-switcher"),mainNav=document.querySelector(".nav");navSwitcher.addEventListener("click",(()=>{navSwitcher.classList.toggle("nav-switcher--active"),mainNav.classList.toggle("nav--active"),document.body.classList.toggle("overflow")}));const mainNavLinksSub=mainNav.querySelectorAll(".sub>a");mainNavLinksSub.forEach((e=>{e.addEventListener("click",(e=>{e.currentTarget.parentElement.classList.toggle("active")}))})),document.querySelector("#contact-map")&&ymaps.ready((function(){let e=document.querySelector("#contact-map").dataset.coord.split(",");console.log(e);let t=new ymaps.Map("contact-map",{center:[parseFloat(e[0].trim()),parseFloat(e[1].trim())],controls:["zoomControl"],zoom:16},{searchControlProvider:"yandex#search"});t.behaviors.disable("scrollZoom"),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&t.behaviors.disable("drag"),myPlacemark=new ymaps.Placemark([parseFloat(e[0].trim()),parseFloat(e[1].trim())],{hintContent:"",balloonContent:""},{iconLayout:"default#image",iconImageHref:document.querySelector("#contact-map").dataset.marker,iconImageSize:[33,33],iconImageOffset:[-16,-16]}),t.geoObjects.add(myPlacemark)}));const swiper2=new Swiper(".mySwiper2",{spaceBetween:50,slidesPerView:1,slideClass:"swiper2-slide",navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"},breakpoints:{768:{enabled:!1}}}),getParentByNode=(e,t)=>{if(e&&e.nodeName!==t)for(;e&&e.nodeName!==t;)e=e.parentNode;return"#document"===e?.nodeName?null:e},getParentByClassname=(e,t)=>{if(e&&e.classList&&!e.classList.contains(t))for(;e&&e.classList&&!e.classList.contains(t);)e=e.parentNode;return"#document"===e?.nodeName?null:e},validation={isNotEmpty:e=>{const t=/(^\s*)|(\s*$)/g;let a=e.value.replace(t,"");return"undefined"!=typeof CKEDITOR&&void 0!==CKEDITOR.instances[e.name]&&(a=CKEDITOR.instances[e.name].getData().replace(t,"")),""!==a},isInt:e=>/^\-?\+?\d+$/.test(e.value),isMail:e=>/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|.(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.value)};window.onload=()=>{const e=new ScrollMagic.Controller,t=document.querySelector("[data-loader]");setTimeout((()=>{t.classList.add("hidden"),setTimeout((()=>t.remove()),500),setTimeout((()=>document.querySelector("html").classList.add("_load")),1500)}),500);const a=document.querySelector("[data-header]");let s=window.pageYOffset;const i=e=>{const t=window.pageYOffset;a.classList[t>5?"add":"remove"]("bg"),e&&a.classList[t<s||t<=10?"remove":"add"]("hidden"),s=t};i(!1),window.addEventListener("scroll",(()=>i(!0)));const r=Array.from(document.querySelectorAll("[data-swiper]"));let o,n,l;window.swipers={};let c=0;for(let e in r){switch(r[e].getAttribute("data-swiper")){case"main":window.swipers.main=new Swiper(r[e],{effect:"fade",loop:!0,allowTouchMove:!1,on:{init:t=>{Array.from(t.el.querySelectorAll("[data-video-btn]")).map((a=>a.addEventListener("click",(({target:a})=>{(a=getParentByNode(a,"BUTTON")).classList.toggle("active"),a.classList.contains("active")?(t.el.classList.toggle("active"),t.el.classList.add("animate1"),setTimeout((()=>t.el.classList.add("animate2")),150)):(t.el.classList.remove("animate2"),setTimeout((()=>{t.el.classList.remove("animate1"),setTimeout((()=>t.el.classList.toggle("active")),150)}),150)),setTimeout((()=>t.el.nextElementSibling.classList.toggle("opacity")),150),document.body.classList.toggle("overflow"),document.body.classList.contains("overflow")?r[e].parentNode.parentNode.classList.add("fullscreen"):setTimeout((()=>r[e].parentNode.parentNode.classList.remove("fullscreen")),700)}))))}}});break;case"main_thumb":new Swiper(r[e],{loop:!0,allowTouchMove:!1,autoHeight:!0,navigation:{nextEl:".main_thumb_next",prevEl:".main_thumb_prev"},on:{slideChange:e=>window.swipers.main.slideTo(e.realIndex)}});break;case"main_side":setTimeout((function(){new Swiper(r[e],{loop:!0,allowTouchMove:!1,autoplay:!0})}),c),c+=1500;break;case"card":o=r[e].querySelector(".swipernavs"),n=o.querySelector(".card_prev"),l=o.querySelector(".card_next"),new Swiper(r[e],{slidesPerView:1.3,breakpoints:{576:{slidesPerView:2},768:{slidesPerView:4}},spaceBetween:16,navigation:{nextEl:l,prevEl:n}});break;case"news":o=r[e].querySelector(".swipernavs"),n=o.querySelector(".news_prev"),l=o.querySelector(".news_next"),new Swiper(r[e],{autoHeight:!0,slidesPerView:1,breakpoints:{768:{slidesPerView:2},1300:{slidesPerView:"auto"}},spaceBetween:16,navigation:{nextEl:l,prevEl:n}});break;case"quiz":const t=r[e].querySelector("[data-quiz-steps]"),a=document.querySelector('[data-quiz-step="prev"]'),s=e=>{t&&(t.innerHTML=`Шаг ${e.realIndex+1}<span>из ${e.slides.length-1}</span>`),e.el.classList[e.realIndex+1===e.slides.length?"add":"remove"]("hidden"),a.classList[e.realIndex?"remove":"add"]("disable")},i=Array.from(document.querySelectorAll("[data-quiz-step]"));window.swipers.quiz=new Swiper(r[e],{slidesPerView:1,effect:"fade",fadeEffect:{crossFade:!0},autoHeight:!0,on:{init:e=>s(e),slideChange:e=>s(e)}});for(let e in i)i[e].addEventListener("click",(({target:e})=>{e=getParentByNode(e,"BUTTON");const t=window.swipers.quiz.realIndex,a=window.swipers.quiz.slides[t],s=Array.from(a.querySelectorAll("[data-validate]"));let i=!1;for(let e in s){let t=!0;switch(s[e].getAttribute("data-validate")){case"text":t=validation.isNotEmpty(s[e]),s[e].classList[t?"remove":"add"]("error"),t||(i=!0);break;case"number":t=validation.isInt(s[e]),s[e].classList[t?"remove":"add"]("error"),t||(i=!0);break;case"email":t=validation.isMail(s[e]),s[e].classList[t?"remove":"add"]("error"),t||(i=!0)}}i||("prev"===e.getAttribute("data-quiz-step")?window.swipers.quiz.slidePrev():window.swipers.quiz.slideNext())}));break;case"history":swiper_hist=window.swipers.history=new Swiper(r[e],{slidesPerView:1,spaceBetween:16,breakpoints:{576:{slidesPerView:2},768:{slidesPerView:4}}});const d=Array.from(r[e].querySelectorAll("[data-history-step]"));swiper_hist.on("slideChange",(function(e){console.log("slide changed"),console.log(e.activeIndex),d.forEach((e=>{e.classList.remove("active")})),d[e.activeIndex].classList.add("active")}));for(let e in d)d[e].addEventListener("click",(({target:e})=>{if(!e.classList.contains("active")){const t=d.find((e=>e.classList.contains("active")));t&&t.classList.remove("active"),e.classList.add("active");const a=e.getAttribute("data-history-step"),s=window.swipers.history.slides.findIndex((e=>e.getAttribute("data-history-target")==a));window.swipers.history.slideTo(s)}}));break;case"values":new Swiper(r[e],{slidesPerView:1.3,spaceBetween:16,breakpoints:{576:{slidesPerView:2},768:{slidesPerView:4}},navigation:{nextEl:".values_next",prevEl:".values_prev"}});break;case"career":new Swiper(r[e],{slidesPerView:1,effect:"fade",fadeEffect:{crossFade:!0},autoHeight:!0,navigation:{nextEl:".next_carrer",prevEl:".prev_carrer"}});break;case"contacts":new Swiper(r[e],{slidesPerView:1,effect:"fade",fadeEffect:{crossFade:!0},autoHeight:!0,navigation:{nextEl:".next_contacts",prevEl:".prev_contacts"}});break;case"where_to_buy":window.swipers.whereToBuy=new Swiper(r[e],{slidesPerView:1,effect:"fade",fadeEffect:{crossFade:!0},autoHeight:!0,navigation:{nextEl:".next_where_to_buy",prevEl:".prev_where_to_buy"}});break;case"contract_production":window.swipers.contractProduction=new Swiper(r[e],{slidesPerView:1,effect:"fade",fadeEffect:{crossFade:!0},autoHeight:!0});const u=Array.from(document.querySelectorAll("[data-contract-production-step]"));for(let e in u)u[e].addEventListener("click",(({target:e})=>{if(!(e=getParentByNode(e,"BUTTON")).classList.contains("active")){const t=document.querySelector("[data-contract-production-step].active");t&&t.classList.remove("active"),e.classList.add("active"),window.swipers.contractProduction.slideTo(parseInt(e.getAttribute("data-contract-production-step")))}}));const m=Array.from(document.querySelectorAll(".tooltip"));for(let e in m){m[e].querySelector(".tooltip__btn").addEventListener("click",(()=>{m[e].classList.toggle("active")}))}break;case"contract_production_why":new Swiper(r[e],{slidesPerView:1,spaceBetween:16,breakpoints:{576:{slidesPerView:2},768:{slidesPerView:4}},navigation:{nextEl:".contract_production_why_next",prevEl:".contract_production_why_prev"}});break;case"gallery":window.swipers.gallery=new Swiper(r[e],{effect:"fade",loop:!0,allowTouchMove:!1,on:{init:t=>{Array.from(t.el.querySelectorAll("[data-video-btn]")).map((a=>a.addEventListener("click",(({target:a})=>{(a=getParentByNode(a,"BUTTON")).classList.toggle("active"),a.classList.contains("active")?(t.el.classList.toggle("active"),t.el.classList.add("animate1"),setTimeout((()=>t.el.classList.add("animate2")),150)):(t.el.classList.remove("animate2"),setTimeout((()=>{t.el.classList.remove("animate1"),setTimeout((()=>t.el.classList.toggle("active")),150)}),150)),setTimeout((()=>t.el.nextElementSibling.classList.toggle("opacity")),150),document.body.classList.toggle("overflow"),document.body.classList.contains("overflow")?r[e].parentNode.parentNode.classList.add("fullscreen"):setTimeout((()=>r[e].parentNode.parentNode.classList.remove("fullscreen")),700)}))))}}});break;case"gallery_thumb":new Swiper(r[e],{breakpoints:{576:{direction:"vertical",spaceBetween:16}},slidesPerView:4,spaceBetween:8,navigation:{nextEl:".gallery_thumb_next",prevEl:".gallery_thumb_prev"},on:{init:e=>{for(let t in e.slides)0==t&&e.slides[t].classList.add("active"),e.slides[t].addEventListener("click",(({target:a})=>{if(!e.slides[t].classList.contains("active")){window.swipers.gallery.slideTo(t),e.slideTo(t);const s=e.slides.find((e=>e.classList.contains("active")));s&&s.classList.remove("active"),(a=getParentByClassname(a,"swiper-slide")).classList.add("active")}}))},slideChange:e=>window.swipers.gallery.slideTo(e.realIndex)}});break;case"product":window.swipers.contractProduction=new Swiper(r[e],{slidesPerView:1,effect:"fade",fadeEffect:{crossFade:!0},autoHeight:!0});const w=Array.from(document.querySelectorAll("[data-product-step]"));for(let e in w)w[e].addEventListener("click",(({target:e})=>{if(!(e=getParentByNode(e,"BUTTON")).classList.contains("active")){const t=document.querySelector("[data-product-step].active");t&&t.classList.remove("active"),e.classList.add("active"),window.swipers.contractProduction.slideTo(parseInt(e.getAttribute("data-product-step")))}}));break;case"swiper_scroll":new Swiper(r[e],{slidesPerView:"auto",freeMode:!0,scrollbar:{el:".swiper-scrollbar"},mousewheel:!0});break;case"similars":new Swiper(r[e],{slidesPerView:2,spaceBetween:8,breakpoints:{576:{slidesPerView:4,spaceBetween:16}},navigation:{nextEl:".similars_next",prevEl:".similars_prev"}});break;case"selectbox":window.swipers.selectbox=new Swiper(r[e],{slidesPerView:1,effect:"fade",fadeEffect:{crossFade:!0},autoHeight:!0});break;case"certificates":const p=getParentByClassname(r[e],"modalbox").querySelector("[data-certificates-steps]"),v=e=>{p&&(p.innerHTML=`${e.realIndex+1} / ${e.slides.length}`)};window.swipers.certificates=new Swiper(r[e],{slidesPerView:1.2,centeredSlides:!0,navigation:{nextEl:".certificates_next",prevEl:".certificates_prev"},breakpoints:{576:{slidesPerView:3}},on:{init:e=>v(e),slideChange:e=>v(e)}})}}const d=document.querySelector("[data-animation-flask]");d&&(new ScrollMagic.Scene({triggerElement:d,duration:600}).setTween(d,{rotate:0}).addTo(e),new ScrollMagic.Scene({triggerElement:d,duration:550}).setTween("[data-animation-flask-fill]",{rotate:0,height:"90%"}).addTo(e));const u=document.querySelector("[data-animation-bottle]");u&&new ScrollMagic.Scene({triggerElement:u,offset:-350,duration:u.clientHeight}).setTween(u,{rotate:0}).addTo(e);const m=document.querySelector("[data-animation-big-logo]"),w=document.querySelector("[data-animation-big-logo-triger]");m&&new ScrollMagic.Scene({triggerElement:m.parentNode,duration:2e3,offset:350}).setTween(m,{bottom:-2*w.clientHeight,opacity:0}).addTo(e);const p=document.querySelector("[data-animation-small-logo]");p&&new ScrollMagic.Scene({triggerElement:p.parentNode,duration:p.clientHeight}).setTween(p,{rotate:0}).addTo(e);const v=window.innerWidth<600?60:120;AOS.init({disable:!1,startEvent:"DOMContentLoaded",initClassName:"aos-init",animatedClassName:"aos-animate",useClassNames:!1,disableMutationObserver:!1,debounceDelay:50,throttleDelay:99,offset:v,delay:0,duration:800,easing:"ease",once:!0,mirror:!1,anchorPlacement:"top-bottom"}),document.addEventListener("aos:in",(({detail:e})=>{const t=parseInt(e.getAttribute("data-count"));if(t){const a=getParentByNode(e,"LI");a.style.width=`${a.offsetWidth}px`,a.style.height=`${a.offsetHeight}px`;let s=parseInt(e.getAttribute("data-step"));s=s||1;let i=0,r=setInterval((()=>{i+=s,e.innerHTML=i,i>=t&&(e.innerHTML=t,a.removeAttribute("style"),clearInterval(r))}),e.getAttribute("data-speed"))}}));const g=Array.from(document.querySelectorAll("[data-scrollbar]"));for(let e in g)new PerfectScrollbar(g[e],{wheelSpeed:.5});const f=Array.from(document.querySelectorAll("[data-modal-triger]"));let y=!1;const L=e=>{y||(y=!0,document.body.classList.toggle("noscroll"),e.classList.contains("open")?(e.classList.remove("open"),setTimeout((()=>{e.classList.remove("active"),y=!1}),200)):(e.classList.add("active"),setTimeout((()=>{e.classList.add("open"),y=!1}),200)))};for(let e in f)f[e].addEventListener("click",(({target:e})=>{if(e=e.classList.contains("modalbox")?e:getParentByNode(e,"BUTTON")){const t=e.classList.contains("modalbox")?e.getAttribute("data-modal-target"):e.getAttribute("data-modal-triger");(e=document.querySelector(`[data-modal-target="${t}"]`))&&L(e)}}));const b=Array.from(document.querySelectorAll("[data-accordion]"));for(let e in b)b[e].addEventListener("click",(({target:e})=>{(e=getParentByNode(e,"BUTTON")).classList.toggle("active"),e.classList.contains("active")?e.nextElementSibling.style.maxHeight=`${e.nextElementSibling.scrollHeight}px`:e.nextElementSibling.removeAttribute("style")}));const S=Array.from(document.querySelectorAll(".selectbox"));for(let e in S)console.log(S[e]),document.addEventListener("click",(function(t){let a=S[e];const s=t.target;s==a||a.contains(s)||(a.querySelector(".hiddenbox").classList.remove("open"),a.querySelector("button").classList.remove("open"))}));const h=Array.from(document.querySelectorAll("[data-select]"));for(let e in h)h[e].addEventListener("click",(({target:e})=>{if(!(e=getParentByNode(e,"BUTTON")).classList.contains("open")){const e=document.querySelector("[data-select].open");e&&(e.classList.remove("open"),e.nextElementSibling.classList.remove("open"))}e.classList.toggle("open"),e.nextElementSibling.classList.toggle("open")}));const E=Array.from(document.querySelectorAll("[data-select-value]"));for(let e in E)E[e].addEventListener("click",(({target:e})=>{e=getParentByNode(e,"BUTTON");const t=getParentByClassname(e,"hiddenbox");t.classList.remove("open"),t.previousElementSibling.classList.remove("open"),t.previousElementSibling.innerHTML=e.innerHTML,window.swipers.selectbox.slideTo(parseInt(e.getAttribute("data-select-value")))}));const T=Array.from(document.querySelectorAll("[datepicker]"));for(let e in T)T[e].addEventListener("input",(()=>{T[e].value=""})),datepicker(T[e],{customDays:["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],customMonths:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],customOverlayMonths:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],overlayButton:"Применить",overlayPlaceholder:"Изменить год ?",formatter:(e,t)=>{e.value=t.toLocaleDateString()}});const q=Array.from(document.querySelectorAll("[data-textbox]"));for(let e in q)q[e].addEventListener("mouseover",(({target:e})=>{(e=(e=getParentByNode(e,"LI")).querySelector(".text")).style.height="100%",e.style.paddingTop="10px"})),q[e].addEventListener("mouseout",(({target:e})=>{(e=(e=getParentByNode(e,"LI")).querySelector(".text")).style.height="0",e.style.paddingTop="0"}));window.lightGalleryInstance=lightGallery(document.querySelector("[lightgallery]"));const x=document.querySelector("[data-test]");x&&x.addEventListener("click",(({target:e})=>{const t=e.parentNode.previousElementSibling;t.innerHTML=t.innerHTML+t.innerHTML,window.lightGalleryInstance.refresh()}));const A=Array.from(document.querySelectorAll("[data-mask]")),k={oncomplete:e=>B(e.currentTarget),onincomplete:e=>B(e.currentTarget)};for(let e in A){if("phone"===A[e].getAttribute("data-mask"))Inputmask({...k,mask:"+7 (999) 999-99-99",clearIncomplete:!0}).mask(A[e])}const _=Array.from(document.querySelectorAll('input[type="text"]')),P=Array.from(document.querySelectorAll("textarea")),N=_.concat(P),B=e=>{e.classList[validation.isNotEmpty(e)?"add":"remove"]("ready"),e.classList.remove("error")};for(let e in N)N[e].addEventListener("input",(({target:e})=>B(e)));const I=Array.from(document.querySelectorAll("[validate]"));let V=!0;for(let e in I)I[e].addEventListener("submit",(t=>{t.preventDefault();const a=Array.from(I[e].querySelectorAll("[data-validate]"));let s=!1;for(let e in a){let t=!0;switch(a[e].getAttribute("data-validate")){case"text":t=validation.isNotEmpty(a[e]),a[e].classList[t?"remove":"add"]("error"),t||(s=!0);break;case"number":t=validation.isInt(a[e]),a[e].classList[t?"remove":"add"]("error"),t||(s=!0)}}if(s)t.preventDefault();else{const a=getParentByClassname(I[e],"modal");a&&L(a),setTimeout((()=>{const e=document.querySelector(`[data-modal-target="${V?"feedback_success":"feedback_error"}"]`);e&&L(e),V=!V}),200),t.preventDefault()}}));searchField.addEventListener("focusin",(()=>{searchForm.classList.add("active")})),searchField.addEventListener("focusout",(()=>{searchForm.classList.remove("active")}))},$((function(){if($(".front-news").length){let e=$(".front-news__swiper .swiper-wrapper");$(".front-news__slide-column").each((function(){$(this).find(".front-news__item").each((function(){console.log(this),e.append(`<div class="swiper-slide front-news__slide-mob"><div class="front-news__item br">${$(this).html()}</div></div>`)}))}));new Swiper(".front-news__swiper",{slidesPerView:2,spaceBetween:16,breakpoints:{576:{slidesPerView:2},1400:{slidesPerView:"auto"}},navigation:{nextEl:$(".front-news__next")[0],prevEl:$(".front-news__prev")[0]}})}}));